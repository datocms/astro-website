---
import { DocCalloutFragment } from './graphql';
import type { FragmentOf } from 'gql.tada';
import { readFragment } from 'gql.tada';
import { ensureValidStructuredTextProps } from '@datocms/astro';
import { Text } from '~/components/structuredText/Text';
import { defaultLinkToRecordComponents } from '~/components/linkToRecords';
import { defaultInlineRecordComponents } from '~/components/inlineRecords';
import Base from './Base.astro';

interface Props {
  block: FragmentOf<typeof DocCalloutFragment>;
}

const { block: maskedBlock } = Astro.props;

const block = readFragment(DocCalloutFragment, maskedBlock);

const { calloutType, title, text } = block;
---

<Base calloutType={calloutType} title={title}>
  <Text
    {...ensureValidStructuredTextProps({
      data: text,
      linkToRecordComponents: defaultLinkToRecordComponents,
      inlineRecordComponents: defaultInlineRecordComponents,
    })}
  />
</Base>
