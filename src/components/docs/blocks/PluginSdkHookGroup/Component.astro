---
import { fetchPluginSdkHooks } from './utils';
import Hook from './Hook/index.astro';
import { PluginSdkHookGroupFragment } from './graphql';
import type { FragmentOf } from 'gql.tada';
import { readFragment } from 'gql.tada';

interface Props {
  block: FragmentOf<typeof PluginSdkHookGroupFragment>;
}

const { block } = Astro.props;

const { groupName } = readFragment(PluginSdkHookGroupFragment, block);

const hooks = (await fetchPluginSdkHooks()).filter((hook) => hook.groups.includes(groupName));
---

{hooks.sort((a, b) => a.lineNumber - b.lineNumber).map((hook) => <Hook hook={hook} />)}
